{% extends 'main.html' %} 
{% load static %} 
{% load crispy_forms_tags %} 
    
    
    {% block header %}
    {#% include "headercss_extension.html" %#}
    {% endblock header %} 
    
    
    {% block content %}

            <!-- Page Heading -->

            <div class="page-breadcrumb">
                <div class="row">
                    <div class="col-12 d-flex no-block align-items-center">
                        <h4 class="page-title">System Settings</h4>
                        <div class="m-l-10">
                            <a class="btn btn-block btn-secondary btn-sm" href="#" data-bs-toggle="modal" data-bs-target="#CreateNotificationModal" aria-expanded="false">
                                <i class="fas fa-plus-circle"></i> Send Notification
                            </a>
                        </div>                        <div class="ms-auto text-end">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="#">Activities</a></li>
                                    <li class="breadcrumb-item active" aria-current="page">
                                        Logs
                                    </li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>


            <div class="container-fluid">


                <div class="row">
                    <!-- column -->
                    <div class="col-lg-6">
                      <div class="card">
                        <div class="card-header">
                            Notifications
                        </div>
                        <div class="card-body">
                          <!-- <h4 class="card-title">Latest Posts</h4> -->
                          <div class="comment-widgets scrollable">
                            <!-- Comment Row -->
                            <div class="d-flex flex-row comment-row mt-0">
                              <div class="p-2">
                                <img
                                  src="../assets/images/users/1.jpg"
                                  alt="user"
                                  width="50"
                                  class="rounded-circle"
                                />
                              </div>
                              <div class="comment-text w-100">
                                <h6 class="font-medium">James Anderson</h6>
                                <span class="mb-3 d-block"
                                  >Lorem Ipsum is simply dummy text of the printing and
                                  type setting industry.
                                </span>
                                <div class="comment-footer">
                                  <span class="text-muted float-end">April 14, 2021</span>
 
                                  <button
                                    type="button"
                                    class="btn btn-success btn-sm rounded-pill text-white"
                                  >
                                    Reply
                                  </button>
                                  <button
                                    type="button"
                                    class="btn btn-danger btn-sm rounded-pill text-white"
                                  >
                                    Delete
                                  </button>
                                </div>
                              </div>
                            </div>

                          </div>
                        </div>

                      </div>
                      <!-- Card -->


                    </div>
                    <!-- column -->
        
                    <div class="col-lg-6">
                      <!-- Card -->
                      <div class="card">
                        <div class="card-header">
                            Chat Option
                        </div>
                        <div class="card-body">
                          <!-- <h4 class="card-title">Chat Option</h4> -->
                          <div class="chat-box scrollable" style="height: 475px">
                            <!--chat Row -->
                            <ul class="chat-list">
                              <!--chat Row -->
                              <li class="chat-item">
                                <div class="chat-img">
                                  <img src="../assets/images/users/1.jpg" alt="user" />
                                </div>
                                <div class="chat-content">
                                  <h6 class="font-medium">James Anderson</h6>
                                  <div class="box bg-light-info">
                                    Lorem Ipsum is simply dummy text of the printing
                                    &amp; type setting industry.
                                  </div>
                                </div>
                                <div class="chat-time">10:56 am</div>
                              </li>
                              <!--chat Row -->
                              <li class="chat-item">
                                <div class="chat-img">
                                  <img src="../assets/images/users/2.jpg" alt="user" />
                                </div>
                                <div class="chat-content">
                                  <h6 class="font-medium">Bianca Doe</h6>
                                  <div class="box bg-light-info">
                                    Itâ€™s Great opportunity to work.
                                  </div>
                                </div>
                                <div class="chat-time">10:57 am</div>
                              </li>
                              <!--chat Row -->
                              <li class="odd chat-item">
                                <div class="chat-content">
                                  <div class="box bg-light-inverse">
                                    I would love to join the team.
                                  </div>
                                  <br />
                                </div>
                              </li>
                              <!--chat Row -->
                              <li class="odd chat-item">
                                <div class="chat-content">
                                  <div class="box bg-light-inverse">
                                    Whats budget of the new project.
                                  </div>
                                  <br />
                                </div>
                                <div class="chat-time">10:59 am</div>
                              </li>
                              <!--chat Row -->
                              <li class="chat-item">
                                <div class="chat-img">
                                  <img src="../assets/images/users/3.jpg" alt="user" />
                                </div>
                                <div class="chat-content">
                                  <h6 class="font-medium">Angelina Rhodes</h6>
                                  <div class="box bg-light-info">
                                    Well we have good budget for the project
                                  </div>
                                </div>
                                <div class="chat-time">11:00 am</div>
                              </li>
                              <!--chat Row -->
                            </ul>
                          </div>
                        </div>
                        <div class="card-body border-top">
                          <div class="row">
                            <div class="col-9">
                              <div class="input-field mt-0 mb-0">
                                <textarea
                                  id="textarea1"
                                  placeholder="Type and enter"
                                  class="form-control border-0"
                                ></textarea>
                              </div>
                            </div>
                            <div class="col-3">
                              <a
                                class="btn-circle btn-lg btn-cyan float-end text-white"
                                href="javascript:void(0)"
                                ><i class="mdi mdi-send fs-3"></i
                              ></a>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- card -->
      
                      <!-- accoridan part -->

                      <!-- Tabs -->

                    </div>
                  </div>

                  

                

                  
            <div class="modal fade none-border" id="CreateNotificationModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Send Notification</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <form action="" method="POST">   
                                    {% csrf_token %}
                                    <input type="hidden" name="author" class="form-control mb-4" id="author" value="{{user.id}}" />
                                
                                    <div class="col-md-12">
                                        <div class="form-group row">
                                            <label for="fname"
                                            class="col-sm-2 text-end control-label col-form-label">Title</label>
                                            <div class="col-sm-10">
                                            <input type="text" class="form-control title" name="title" aria-describedby="" placeholder="" required/>
                                            </div>
                                        </div>                                        
                                    </div>

                                    <div class="col-md-12">
                                        <div class="form-group row">
                                            <label for="fname"
                                            class="col-sm-2 text-end control-label col-form-label">Description</label>
                                            <div class="col-sm-10">
                                                <textarea class="form-control description" name="description" id="eventDescription" maxlength="100" required></textarea>
                                            </div>
                                        </div>                                        
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <div class="form-group row">
                                            <label for="recipient"
                                            class="col-sm-2 text-end control-label col-form-label">Recipient</label>
                                            <div class="col-md-10">
                                                <select 
                                                  class="select2 form-select shadow-none mt-3 recipient"
                                                  multiple="multiple"
                                                  style="height: 36px; width: 100%"
                                                >
                                                  <optgroup label="Select one or many or all">
                                                    <option value="all">All</option>
                                                    {% for user in users %}
                                                      <option value="{{user.id}}">{{user.first_name}} {{user.last_name}}</option>
                                                    {% endfor %}
                                                  </optgroup>                          
                          
                                                </select>
                                              </div>
                                        </div>                                        
                                    </div>

                                    <div class="col-md-12">
                                      <div class="form-group row">
                                        <label for="recipient"
                                        class="col-sm-2 text-end control-label col-form-label">Category</label>
                                        <div class="col-md-10">
                                          <select 
                                            class="form-select shadow-none category"
                                            style="height: 36px; width: 100%"                                            
                                          >
                                            <option value="">Select...</option>
                                            <option value="info" selected>Information</option>
                                            <option value="success">Success</option>
                                            <option value="warning">Warning</option>
                                            <option value="error">Error</option>
                                          </select>
                                        </div>
                                      </div>                                        
                                  </div>

                                </form> 
                            </div>
                            
                        </div>
                        <div class="modal-footer">
                            <!-- <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button> -->
                            <button class="btn btn-secondary" id="send-notification" 
                            onclick="" type="button" data-dismiss="modal">Yes Send!</button>
                        </div>
                    </div>
                </div>
            </div>  

            </div>


    {% endblock content %} 
    
    
    
    {% block footerjs %}
    <!----- cut off ---->
<script>
            
    $(document).ready(function() {

      $('#CreateNotificationModal').on('shown.bs.modal', function(e) {
        
        $('#send-notification').click(function(e){
          e.preventDefault();  

          $.post('{% url "send_notification" %}',
            {
            title: $('.title').val(),
            description: $('.description').val(),
            recipient: $('.recipient').val(),
            level: $('.category').val(),
            csrfmiddlewaretoken: $('input[name="csrfmiddlewaretoken"]').val()
            },
            function(data){
              if (data['status'] == 'ok') {
                title: $('.title').val(''),
                $('.description').val(''),
                $('.recipient').val(''),
                $('#CreateNotificationModal').modal('hide');
                tryc("success", "Success: Notification sent!"); 
              }
            }
          );
        });

      });


    });
        
</script>

    {% endblock footerjs %}

